<div>
    <section class="section">
        <div class="project-container">
            <!-- side bar -->
            <div class="sidebar">
                <!-- tabs -->
                <ul class="navigation">
                    <li ng-click="projectCtrl.currentTab = 'description'"
                        title="Go to the description tab"
                        ng-class="projectCtrl.currentTab == 'description'? 'active':''">
                        Description
                    </li>
                    <li ng-click="projectCtrl.currentTab = 'instructions'"
                        title="Go to the instructions tab"
                        ng-class="projectCtrl.currentTab == 'instructions'? 'active':''">
                        Instructions

                    </li>
                    <li ng-click="projectCtrl.currentTab = 'mapping'"
                        title="Go to the mapping tab"
                        ng-class="projectCtrl.currentTab == 'mapping'? 'active':''">
                        Map
                    </li>
                    <li ng-click="projectCtrl.currentTab = 'validation'"
                        ng-class="projectCtrl.currentTab == 'validation'? 'active':''">
                        Validate
                    </li>
                </ul>
                <div class="content">

                    <div ng-show="projectCtrl.currentTab === 'description'">
                        <button class="button button--secondary pull-right"
                                ng-click="projectCtrl.currentTab = 'instructions'">
                            Instructions <i class="hot-ds-icon-sm-chevron-right"></i>
                        </button>
                        <section>
                            <h2>Description</h2>
                            <h4>
                                #{{ projectCtrl.projectData.projectId }}-{{ projectCtrl.projectData.projectInfo.name }}</h4>
                            <div>
                                <mark>Priority: {{ projectCtrl.projectData.projectPriority }}</mark>
                            </div>
                            <p ng-bind-html="description"></p>
                        </section>
                    </div>
                    <div ng-show="projectCtrl.currentTab === 'instructions'">

                        <button class="button button--secondary pull-right"
                                ng-click="projectCtrl.currentTab = 'validation'">Validate
                            <i class="hot-ds-icon-sm-chevron-right"></i>
                        </button>

                        <button class="button button--secondary pull-right"
                                ng-click="projectCtrl.currentTab = 'mapping'">Map
                            <i class="hot-ds-icon-sm-chevron-right"></i>
                        </button>

                        <section>
                            <h2>Instructions</h2>
                            <div ng-init="showEntitiesHelp = false">
                                <strong>Entities to Map <i ng-click="showEntitiesHelp = !showEntitiesHelp"
                                                       class="hot-ds-icon-circle-question pointer"></i></strong>
                                <div ng-show="showEntitiesHelp">
                                    <small><em>The list of elements we ask you to map</em></small>
                                </div>
                                <div><code>{{ projectCtrl.projectData.entitiesToMap }}</code></div>
                            </div>
                            <hr/>
                            <div ng-init="showChangesetCommentHelp = false">
                                <strong>Changeset Comment <i ng-click="showChangesetCommentHelp = !showChangesetCommentHelp"
                                                         class="hot-ds-icon-circle-question pointer"></i></strong>
                                <div ng-show="showChangesetCommentHelp">
                                    <small><em>The default comment entered when uploaded data to the OSM database. When
                                        saving your work,
                                        please leave the default comment but add what you actually mapped, for example
                                        "added
                                        buildings and a residential road"
                                    </em></small>
                                </div>
                                <div><code>{{ projectCtrl.projectData.changesetComment }}</code></div>
                            </div>
                            <hr/>
                            <p ng-bind-html="instructions"></p>
                        </section>

                    </div>
                    <div ng-show="projectCtrl.currentTab === 'mapping'">
                        <!-- select UI -->
                        <div ng-show="projectCtrl.mappingStep === 'selecting'">
                            <h3>Choose a task</h3>
                            <div ng-show="projectCtrl.lockedTasksForCurrentUser.length > 0"
                                 class="alert alert--warning"
                                 role="alert">
                                <p>You cannot select tasks for mapping because you already have one or more tasks
                                    locked. Use the map to re-select and complete these tasks to allow new tasks to be
                                    selected.</p>
                            </div>
                            <div ng-hide="projectCtrl.lockedTasksForCurrentUser.length > 0">
                                <p>Choose a task for mapping:</p>

                                <p><strong>Option 1: </strong>Select a task by clicking on the map</p>
                                <p><strong>Option 2: </strong>
                                    <button ng-click="projectCtrl.selectRandomTaskMap()"
                                            class="button button--secondary pull-center">
                                        Select a random task
                                    </button>
                                </p>
                                <div ng-show="projectCtrl.taskErrorMapping === 'none-available'">
                                    <div class="alert alert--danger" role="alert">
                                        <p>There are no tasks currently available for mapping.</p>
                                    </div>
                                </div>
                                <div ng-show="projectCtrl.taskErrorMapping === 'task-get-error'"
                                     class="alert alert--danger"
                                     role="alert">
                                    <button class="alert__button-dismiss" title="Dismiss alert"
                                            ng-click="projectCtrl.clearCurrentSelection()"><span>Dismiss</span>
                                    </button>
                                    <p>There was an error retrieving the task from the server.</p>
                                </div>
                            </div>
                        </div>
                        <!-- task viewing and mapping UI's -->
                        <div ng-show="projectCtrl.mappingStep === 'viewing' || projectCtrl.mappingStep === 'locked'">
                            <!-- task viewing UI -->
                            <div ng-show="projectCtrl.mappingStep === 'viewing' ">
                                <!-- task information -->
                                <h2>Mapping</h2>
                                <h3>Task
                                    #{{ projectCtrl.selectedTaskData.taskId }}
                                    is {{ projectCtrl.selectedTaskData.taskStatus }}
                                    <span ng-show="projectCtrl.selectedTaskData.taskStatus === 'LOCKED_FOR_MAPPING' || projectCtrl.selectedTaskData.taskStatus === 'LOCKED_FOR_VALIDATION' "> by
                                         <span ng-show="projectCtrl.selectedTaskData.lockHolder === projectCtrl.user.username">
                                            you
                                         </span>
                                         <span ng-show="projectCtrl.selectedTaskData.lockHolder !== projectCtrl.user.username">
                                            {{ projectCtrl.selectedTaskData.lockHolder }}
                                         </span>
                                    </span>
                                </h3>
                                <div ng-show="projectCtrl.lockedTasksForCurrentUser.length > 0"
                                     class="alert alert--warning"
                                     role="alert">
                                    <p>You cannot select tasks for mapping because you already have one or more tasks
                                        locked. Use the map to re-select and complete these tasks to allow new tasks to
                                        be selected.</p>
                                </div>
                                <div ng-hide="projectCtrl.lockedTasksForCurrentUser.length > 0">
                                    <div ng-show="projectCtrl.taskLockError && projectCtrl.isAuthorized">
                                        <div class="alert alert--danger" role="alert">
                                            <p>The task could not be locked for
                                                mapping. {{ projectCtrl.taskLockErrorMessage }}</p>
                                        </div>
                                    </div>
                                    <div ng-show="projectCtrl.taskLockError && !projectCtrl.isAuthorized">
                                        <div class="alert alert--danger" role="alert">
                                            <p>Please login first.</p>
                                        </div>
                                    </div>
                                    <div ng-hide="projectCtrl.taskLockError">


                                        <div ng-show="projectCtrl.selectedTaskData ">
                                            <div ng-show="projectCtrl.isSelectedMappable && !projectCtrl.taskLockError"
                                                 class="alert alert--success"
                                                 role="alert">
                                                <p>This task is available for mapping.</p>
                                            </div>
                                        </div>
                                        <!-- task error alerts -->
                                        <div>
                                            <div ng-show="!projectCtrl.isSelectedMappable && !projectCtrl.taskLockError"
                                                 class="alert alert--danger"
                                                 role="alert">
                                                <p>The selected task is not available for mapping.</p>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- task action buttons -->
                                    <div>
                                        <div class="pull-center">
                                            <button ng-show="projectCtrl.isSelectedMappable && !projectCtrl.taskLockError"
                                                    class="button button--secondary button--large"
                                                    ng-click="projectCtrl.lockSelectedTaskMapping()">
                                                Start Mapping
                                            </button>
                                        </div>
                                        <hr/>
                                        <div class="pull-center">
                                            <div class="button-group button-group--horizontal" role="group"
                                                 aria-label="other options">
                                                <button ng-hide="projectCtrl.taskErrorMapping === 'none-available'"
                                                        ng-click="projectCtrl.selectRandomTaskMap()"
                                                        class="button button--achromic">
                                                    Select another task
                                                </button>
                                                <button class="button button--achromic"
                                                        ng-click="projectCtrl.resetToSelectingStep()">
                                                    Cancel
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- task locked UI -->
                            <div ng-show="projectCtrl.mappingStep === 'locked'"><!-- task mapping UI -->
                                <h3>Task
                                    #{{ projectCtrl.lockedTaskData.taskId }}
                                    is {{ projectCtrl.lockedTaskData.taskStatus }} by
                                    <span ng-show="projectCtrl.lockedTaskData.lockHolder === projectCtrl.user.username">
                                        you
                                    </span>
                                    <span ng-show="projectCtrl.lockedTaskData.lockHolder !== projectCtrl.user.username">
                                        {{ projectCtrl.lockedTaskData.lockHolder }}
                                    </span>
                                </h3>
                                <p></p>
                                <div class="form__group">
                                    <div class="form__input-group">
                                        <select class="form__control form__control__medium"
                                                ng-model="projectCtrl.selectedEditor">
                                            <option value="ideditor" selected="true">iD Editor</option>
                                            <option value="josm">JOSM</option>
                                            <option value="potlatch2">Potlatch 2</option>
                                            <option value="fieldpapers">Field papers</option>
                                        </select>
                                        <span class="form__input-group-button">
                                            <button class="button button--secondary"
                                                    ng-click="projectCtrl.startEditor(projectCtrl.selectedEditor)">
                                                Start Editor
                                            </button>
                                        </span>
                                    </div>
                                </div>
                                <div ng-show="projectCtrl.selectedEditor === 'josm'">Download the following
                                    <a ng-href="{{ projectCtrl.getGpxDownloadURL() }}" target="_self">gpx file</a> and load it in JOSM to
                                    see the task boundary.
                                </div>
                                <div ng-show="projectCtrl.editorStartError === 'josm-error'">
                                    <div class="alert alert--danger" role="alert">
                                        <button class="alert__button-dismiss" title="Dismiss alert"
                                                ng-click="projectCtrl.editorStartError = ''">
                                            <span>Dismiss</span>
                                        </button>
                                        <p>JOSM remote control did not respond. Do you have JOSM running and
                                            configured to be controlled remotely?</p>
                                    </div>
                                </div>
                                <div class="form__group">
                                    <textarea ng-model="projectCtrl.comment" class="form__control" rows="4"
                                              maxlength="{{ projectCtrl.maxlengthComment }}"
                                              placeholder="Leave a comment"></textarea>
                                    <p class="pull-right">{{ projectCtrl.maxlengthComment - projectCtrl.comment.length }}
                                        characters remaining</p>
                                </div>
                                <div class="form__group pull-center">
                                    <button class="button button--achromic"
                                            ng-click="projectCtrl.unLockTaskMapping(projectCtrl.comment, 'READY')">
                                        Stop Mapping
                                    </button>
                                </div>
                                <div class="form__group pull-center">
                                    <div class="button-group button-group--horizontal" role="group">
                                        <button class="button button--secondary"
                                                ng-click="projectCtrl.unLockTaskMapping(projectCtrl.comment, 'MAPPED')">
                                            Mark as Mapped
                                        </button>
                                        <button class="button button--secondary"
                                                ng-click="projectCtrl.unLockTaskMapping(projectCtrl.comment, 'BADIMAGERY')">
                                            Mark as Bad Imagery
                                        </button>
                                    </div>
                                </div>
                                <div ng-show="projectCtrl.taskUnLockError">
                                    <div>
                                        <div class="alert alert--danger" role="alert">
                                            <p>There was a problem unlocking the
                                                task. {{ projectCtrl.taskUnLockErrorMessage }}</p>
                                        </div>
                                    </div>
                                    <button class="button button--achromic"
                                            ng-click="projectCtrl.resetToSelectingStep()">
                                        Cancel
                                    </button>
                                </div>
                            </div>

                        </div>
                    </div>
                    <div ng-show="projectCtrl.currentTab === 'validation'">
                        <!-- select UI -->
                        <div ng-show="projectCtrl.validatingStep === 'selecting'">
                            <h3>Select for validation</h3>
                            <p>Choose a task for validation:</p>
                            <p><strong>Option 1: </strong>Select a task by clicking on the map</p>
                            <p><strong>Option 2: </strong>
                                <button ng-click="projectCtrl.selectRandomTaskValidate()"
                                        class="button button--secondary pull-center">
                                    Select a random task
                                </button>
                            </p>
                            <div ng-show="projectCtrl.taskErrorValidation === 'none-available'">
                                <div class="alert alert--danger" role="alert">
                                    <p>There are no tasks currently available for validation.</p>
                                </div>
                            </div>
                            <div ng-show="projectCtrl.taskErrorValidation === 'task-get-error'">
                                <div class="alert alert--danger" role="alert">
                                    <button class="alert__button-dismiss" title="Dismiss alert"
                                            ng-click="projectCtrl.clearCurrentSelection()"><span>Dismiss</span>
                                    </button>
                                    <p>there was an error retrieving the task from the server.</p>
                                </div>
                            </div>
                            <div ng-show="projectCtrl.mappedTasksPerUser.length > 0">
                                <p><strong>Option 3: </strong> Select By user:
                                </p>
                                <div ng-show="projectCtrl.taskLockError && projectCtrl.isAuthorized">
                                    <div class="alert alert--danger" role="alert">
                                        <p>The tasks could not be
                                            locked. {{ projectCtrl.taskLockErrorMessage }}</p>
                                    </div>
                                </div>
                                <div ng-show="projectCtrl.taskLockError && !projectCtrl.isAuthorized">
                                    <div class="alert alert--danger" role="alert">
                                        <p>Please login first.</p>
                                    </div>
                                </div>
                                <table class="table table-validate_user table--zebra user-activity-for-validation">
                                    <thead>
                                    <tr>
                                        <th nowrap ng-click="projectCtrl.sortBy('username')"><a class="table__sort table__sort--none" title="Sort column"><span>Contributer</span></a></th>
                                        <th nowrap ng-click="projectCtrl.sortBy('mappingLevel')"><a class="table__sort table__sort--none" title="Sort column"><span>Level</span></a></th>
                                        <th nowrap ng-click="projectCtrl.sortBy('mappedTaskCount')"><a class="table__sort table__sort--none" title="Sort column"><span>Mapped</span></a></th>
                                        <th nowrap ng-click="projectCtrl.sortBy('lastSeen')"><a class="table__sort table__sort--none" title="Sort column"><span>Newest</span></a></th>
                                        <th nowrap><span>Lock</span></th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr ng-repeat="doneTasks in projectCtrl.mappedTasksPerUser | orderBy:projectCtrl.propertyName:projectCtrl.reverse"
                                    >
                                        <td><a href="./user/{{ doneTasks.username }}"/>{{ doneTasks.username }}</td>
                                        <td>{{ doneTasks.mappingLevel }}</td>
                                        <td>{{ doneTasks.mappedTaskCount }}</td>
                                        <td><span am-time-ago="doneTasks.lastSeen | amUtc | amLocal"></span>
                                        </td>
                                        <td>
                                            <button ng-click="projectCtrl.lockTasksForValidation(doneTasks.tasksMapped)"
                                                    ng-mouseover="projectCtrl.highlightTasks(doneTasks.tasksMapped, true)"
                                                    ng-mouseleave="projectCtrl.highlightVectorLayer.getSource().clear()">
                                                Start Validating
                                            </button>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!-- task viewing and mapping UI's -->
                        <div ng-show="projectCtrl.validatingStep === 'viewing' || projectCtrl.validatingStep === 'locked' || projectCtrl.validatingStep === 'multi-locked'">
                            <!-- task viewing UI -->
                            <div ng-show="projectCtrl.validatingStep === 'viewing' ">
                                <!-- task information -->
                                <h2>Validation</h2>
                                <div ng-show="projectCtrl.taskLockError && projectCtrl.isAuthorized">
                                    <div class="alert alert--danger" role="alert">
                                        <p>The task could not be locked for
                                            validation. {{ projectCtrl.taskLockErrorMessage }}</p>
                                    </div>
                                </div>
                                <div ng-show="projectCtrl.taskLockError && !projectCtrl.isAuthorized">
                                    <div class="alert alert--danger" role="alert">
                                        <p>Please login first.</p>
                                    </div>
                                </div>
                                <div ng-hide="projectCtrl.taskLockError">
                                    <h3>Task
                                        #{{ projectCtrl.selectedTaskData.taskId }}
                                        is {{ projectCtrl.selectedTaskData.taskStatus }}
                                        <span ng-show="projectCtrl.selectedTaskData.taskStatus === 'LOCKED_FOR_MAPPING' || projectCtrl.selectedTaskData.taskStatus === 'LOCKED_FOR_VALIDATION' "> by
                                        <span ng-show="projectCtrl.selectedTaskData.lockHolder === projectCtrl.user.username">
                                            you
                                        </span>
                                        <span ng-show="projectCtrl.selectedTaskData.lockHolder !== projectCtrl.user.username">
                                            {{ projectCtrl.selectedTaskData.lockHolder }}
                                        </span>
                                    </span>
                                    </h3>
                                    <div ng-show="projectCtrl.selectedTaskData">
                                        <div ng-show="projectCtrl.isSelectedValidatable && !projectCtrl.taskLockError"
                                             class="alert alert--success"
                                             role="alert">
                                            <p>This task is available for validation.</p>
                                        </div>
                                    </div>
                                    <!-- task error alerts -->
                                    <div>
                                        <div ng-show="!projectCtrl.isSelectedValidatable && !projectCtrl.taskLockError"
                                             class="alert alert--danger"
                                             role="alert">
                                            <p>The selected task is not available for validation.</p>
                                        </div>
                                    </div>
                                </div>
                                <!-- task action buttons -->
                                <div>
                                    <div class="pull-center">
                                        <button ng-show="projectCtrl.isSelectedValidatable && !projectCtrl.taskLockError"
                                                class="button button--secondary button--large"
                                                ng-click="projectCtrl.lockSelectedTaskValidation()">
                                            Start Validating
                                        </button>
                                    </div>
                                    <hr/>
                                    <div class="pull-center">
                                        <div class="button-group button-group--horizontal" role="group"
                                             aria-label="other options">
                                            <button ng-hide="projectCtrl.taskErrorMapping === 'none-available'"
                                                    ng-click="projectCtrl.selectRandomTaskValidate()"
                                                    class="button button--achromic">
                                                Select another task
                                            </button>
                                            <button class="button button--achromic"
                                                    ng-click="projectCtrl.resetToSelectingStep()">
                                                Cancel
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- task locked UI -->
                            <div ng-show="projectCtrl.validatingStep === 'locked'"><!-- task mapping UI -->
                                <h3>Task
                                    #{{ projectCtrl.lockedTaskData.taskId }}
                                    is {{ projectCtrl.lockedTaskData.taskStatus }} by
                                    <span ng-show="projectCtrl.lockedTaskData.lockHolder === projectCtrl.user.username">
                                        you
                                    </span>
                                    <span ng-show="projectCtrl.lockedTaskData.lockHolder !== projectCtrl.user.username">
                                        {{ projectCtrl.lockedTaskData.lockHolder }}
                                    </span>
                                </h3>
                                <p></p>
                                <div class="form__group">
                                    <div class="form__input-group">
                                        <select class="form__control form__control__medium"
                                                ng-model="projectCtrl.selectedEditor">
                                            <option value="ideditor" selected="true">iD Editor</option>
                                            <option value="josm">JOSM</option>
                                            <option value="potlatch2">Potlatch 2</option>
                                            <option value="fieldpapers">Field papers</option>
                                        </select>
                                        <span class="form__input-group-button">
                                            <button class="button button--secondary"
                                                    ng-click="projectCtrl.startEditor(projectCtrl.selectedEditor)">
                                                    Start Editor
                                            </button>
                                        </span>
                                    </div>
                                </div>
                                <div ng-show="projectCtrl.selectedEditor === 'josm'">Download the following <a
                                        ng-href="{{ projectCtrl.getGpxDownloadURL() }}" target="_self">gpx file</a>
                                    file and load it in JOSM to see the task boundary.
                                </div>
                                <div ng-show="projectCtrl.editorStartError === 'josm-error'">
                                    <div class="alert alert--danger" role="alert">
                                        <button class="alert__button-dismiss" title="Dismiss alert"
                                                ng-click="projectCtrl.editorStartError = ''">
                                            <span>Dismiss</span>
                                        </button>
                                        <p>JOSM remote control did not respond. Do you have JOSM running and
                                            configured to be controlled remotely?</p>
                                    </div>
                                </div>
                                <div class="form__group">
                                    <textarea ng-model="projectCtrl.comment" class="form__control" rows="4"
                                              maxlength="{{ projectCtrl.maxlengthComment }}"
                                              placeholder="Leave a comment"></textarea>
                                    <p class="pull-right">{{ projectCtrl.maxlengthComment - projectCtrl.comment.length }}
                                        characters remaining</p>
                                </div>
                                <div class="form__group pull-center">
                                    <button class="button button--achromic"
                                            ng-click="projectCtrl.unLockTaskValidation(projectCtrl.comment, 'MAPPED')">
                                        Stop Validating
                                    </button>
                                </div>
                                <div class="form__group pull-center">
                                    <div class="button-group button-group--horizontal" role="group">
                                        <button class="button button--secondary"
                                                ng-click="projectCtrl.unLockTaskValidation(projectCtrl.comment, 'VALIDATED')">
                                            Mark as Valid
                                        </button>
                                        <button class="button button--secondary"
                                                ng-click="projectCtrl.unLockTaskValidation(projectCtrl.comment, 'INVALIDATED')">
                                            Mark as Invalid
                                        </button>
                                    </div>
                                </div>
                                <div ng-show="projectCtrl.taskUnLockError">
                                    <div>
                                        <div class="alert alert--danger" role="alert">
                                            <p>There was a problem unlocking the
                                                task. {{ projectCtrl.taskUnLockErrorMessage }}</p>
                                        </div>
                                    </div>
                                    <button class="button button--achromic"
                                            ng-click="projectCtrl.resetToSelectingStep()">
                                        Cancel
                                    </button>
                                </div>

                            </div>
                            <div ng-show="projectCtrl.validatingStep === 'multi-locked'">
                                <h2>Multi Task Validation</h2>
                                <h3>Tasks ID's {{ projectCtrl.getSelectTaskIds() }} are LOCKED_FOR_VALIDATION by you.
                                </h3>
                                <div class="form__group">
                                    <div class="form__input-group">
                                        <select class="form__control form__control__medium"
                                                ng-model="projectCtrl.selectedEditor">
                                            <option value="ideditor" selected="true">iD Editor</option>
                                            <option value="josm">JOSM</option>
                                            <option value="potlatch2">Potlatch 2</option>
                                            <option value="fieldpapers">Field papers</option>
                                        </select>
                                        <span class="form__input-group-button">
                                            <button class="button button--secondary"
                                                    ng-click="projectCtrl.startEditor(projectCtrl.selectedEditor)">
                                                Start Editor
                                            </button>
                                        </span>
                                    </div>
                                </div>
                                <div ng-show="projectCtrl.selectedEditor === 'josm'">Since you have multiple tasks
                                    the OSM data in JOSM manually. Download the following <a
                                            ng-href="{{ projectCtrl.getGpxDownloadURL() }}" target="_self">gpx file</a> file and load it
                                    in JOSM to see the task boundaries.
                                </div>
                                <div ng-show="projectCtrl.editorStartError === 'josm-error'">
                                    <div class="alert alert--danger" role="alert">
                                        <button class="alert__button-dismiss" title="Dismiss alert"
                                                ng-click="projectCtrl.editorStartError = ''">
                                            <span>Dismiss</span>
                                        </button>
                                        <p>JOSM remote control did not respond. Do you have JOSM running and
                                            configured to be controlled remotely?</p>
                                    </div>
                                </div>
                                <div class="form__group">
                                    <textarea ng-model="projectCtrl.comment" class="form__control" rows="4"
                                              maxlength="{{ projectCtrl.maxlengthComment }}"
                                              placeholder="Leave a comment on all tasks"></textarea>
                                    <p class="pull-right">{{ projectCtrl.maxlengthComment - projectCtrl.comment.length }}
                                        characters remaining</p>
                                </div>
                                <div class="form__group pull-center">
                                    <button class="button button--achromic"
                                            ng-click="projectCtrl.unLockMultiTaskValidation(projectCtrl.comment, 'MAPPED')">
                                        Stop Validating
                                    </button>
                                </div>
                                <div class="form__group pull-center">
                                    <div class="button-group button-group--horizontal" role="group">
                                        <button class="button button--secondary"
                                                ng-click="projectCtrl.unLockMultiTaskValidation(projectCtrl.comment, 'VALIDATED')">
                                            Mark all as Valid
                                        </button>
                                        <button class="button button--secondary"
                                                ng-click="projectCtrl.unLockMultiTaskValidation(projectCtrl.comment, 'INVALIDATED')">
                                            Mark all as Invalid
                                        </button>
                                    </div>
                                </div>
                                <div ng-show="projectCtrl.taskUnLockError">
                                    <div>
                                        <div class="alert alert--danger" role="alert">
                                            <p>There was a problem unlocking the
                                                tasks. {{ projectCtrl.taskUnLockErrorMessage }}</p>
                                        </div>
                                    </div>
                                    <button class="button button--achromic"
                                            ng-click="projectCtrl.resetToSelectingStep()">
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- advanced options UI -->
                    <div ng-init="showAdvanced=false"
                         ng-show="projectCtrl.selectedTaskData && (projectCtrl.currentTab === 'mapping' || projectCtrl.currentTab === 'validation') && (projectCtrl.mappingStep === 'mapping' || projectCtrl.mappingStep === 'viewing')">
                        <hr/>
                        <div>
                            <h3 ng-click="showAdvanced=!showAdvanced" class="pointer"
                                title="show advanced options">
                                Advanced
                                <i ng-show="!showAdvanced"
                                   class="hot-ds-icon-sm-chevron-down"></i>
                                <i ng-show="showAdvanced"
                                   class="hot-ds-icon-sm-chevron-up"></i>
                            </h3>
                            <p>Advanced task information and editing options</p>
                        </div>
                        <div ng-show="showAdvanced">
                            <div>
                                <h6>Details</h6>
                                <dl class="dl-horizontal">
                                    <dt>ID</dt>
                                    <dd>#{{ projectCtrl.selectedTaskData.taskId }}</dd>
                                    <dt>Status</dt>
                                    <dd>{{ projectCtrl.selectedTaskData.taskStatus }}</dd>
                                </dl>
                            </div>
                            <div ng-init="showHistory=false">
                                <h6 class="heading-alt" ng-click="showHistory=!showHistory">History
                                    <i ng-show="!showHistory"
                                       class="hot-ds-icon-sm-chevron-down">
                                    </i>
                                    <i ng-show="showHistory"
                                       class="hot-ds-icon-sm-chevron-up">
                                    </i>
                                </h6>
                                <div class="history">
                                    <div ng-show="showHistory"
                                         ng-repeat="item in projectCtrl.selectedTaskData.taskHistory | orderBy: '-actionDate' track by $index"
                                         ng-class-odd="'odd'" ng-class-even="'even'">
                                        <div>
                                            <span ng-show="item.action === 'COMMENT'">Comment left by <a
                                                    href="/user/{{ item.actionBy }}">{{ item.actionBy }}</a></span>
                                            <span ng-show="item.action === 'LOCKED_FOR_MAPPING'">Locked for mapping by <a
                                                    href="/user/{{ item.actionBy }}">{{ item.actionBy }}</a></span>
                                            <span ng-show="item.action === 'LOCKED_FOR_VALIDATION'">Locked for validation by <a
                                                    href="/user/{{ item.actionBy }}">{{ item.actionBy }}</a></span>
                                            <span ng-show="item.action === 'STATE_CHANGE' && item.actionText === 'BADIMAGERY'">Marked as bad imagery by <a
                                                    href="/user/{{ item.actionBy }}">{{ item.actionBy }}</a></span>
                                            <span ng-show="item.action === 'STATE_CHANGE' && item.actionText === 'MAPPED'">Mapped by <a
                                                    href="/user/{{ item.actionBy }}">{{ item.actionBy }}</a></span>
                                            <span ng-show="item.action === 'STATE_CHANGE' && item.actionText === 'VALIDATED'">Validated by <a
                                                    href="/user/{{ item.actionBy }}">{{ item.actionBy }}</a></span>
                                            <span ng-show="item.action === 'STATE_CHANGE' && item.actionText === 'INVALIDATED'">Invalidated by <a
                                                    href="/user/{{ item.actionBy }}">{{ item.actionBy }}</a></span>
                                            <span ng-show="item.action === 'STATE_CHANGE' && item.actionText === 'READY'">Marked as ready by <a
                                                    href="/user/{{ item.actionBy }}">{{ item.actionBy }}</a></span>
                                        </div>
                                        <div>
                                            <span ng-show="item.action === 'COMMENT'">{{ item.actionText }}</span>
                                        </div>
                                        <div>
                                            <span am-time-ago="item.actionDate | amUtc | amLocal"></span>
                                            <span ng-show="item.action === 'LOCKED_FOR_MAPPING'"> for {{ item.actionText |  amDurationFormat : 'minute'}} </span>
                                            <span ng-show="item.action === 'LOCKED_FOR_VALIDATION'"> for {{ item.actionText |  amDurationFormat : 'minute'}} </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h6>Options</h6>
                                <div class="button-group button-group--vertical" role="group"
                                     aria-label="advanced options">
                                    <button class="button button--achromic"
                                            title="See the changesets in the OSM database for this area"
                                            ng-click="projectCtrl.viewOSMChangesets()">
                                        View OSM changesets
                                    </button>
                                    <button class="button button--achromic"
                                            title="See the changesets in Overpass turbo for this area"
                                            ng-click="projectCtrl.viewOverpassTurbo()">
                                        View in Overpass Turbo
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="map" class="map-container">
                <div class="mapping-legend">
                    <img src="./assets/img/legend.png" width="109px" height="132px"/>
                </div>
                <div class="project-title">
                    <h2 class="section__title">
                        #{{ projectCtrl.projectData.projectId }} - {{ projectCtrl.projectData.projectInfo.name }}
                    </h2>
                </div>
                <div>

                    <div ng-show="projectCtrl.user.role === 'PROJECT_MANAGER' || projectCtrl.user.role === 'ADMIN'"
                         class="edit-project-button">
                        <a href="/admin/edit-project/{{ projectCtrl.projectData.projectId }}"
                           class="button button--secondary">Edit project</a>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>
